<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkarGrid - Performance Test</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/skargrid@latest/dist/skargrid.min.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8fafc;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .performance-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            text-align: center;
        }
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #2563eb;
            margin: 10px 0;
        }
        .metric-label {
            color: #6b7280;
            font-size: 14px;
        }
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        button {
            padding: 10px 20px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
        }
        button:hover {
            background: #f3f4f6;
        }
        button:active {
            background: #e5e7eb;
        }
        .table-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .loading {
            text-align: center;
            padding: 50px;
            color: #6b7280;
        }
        .benchmark-results {
            background: #f1f5f9;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-line;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° SkarGrid - Teste de Performance</h1>
            <p>Teste com grandes volumes de dados para avaliar performance e escalabilidade</p>
        </div>

        <div class="performance-panel">
            <div class="metric-card">
                <div class="metric-label">Registros Carregados</div>
                <div class="metric-value" id="recordsCount">0</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Tempo de Renderiza√ß√£o</div>
                <div class="metric-value" id="renderTime">0ms</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Registros Filtrados</div>
                <div class="metric-value" id="filteredCount">0</div>
            </div>
            <div class="metric-card">
                <div class="metric-label">Uso de Mem√≥ria</div>
                <div class="metric-value" id="memoryUsage">0MB</div>
            </div>
        </div>

        <div class="controls">
            <button onclick="loadData(1000)">üìä 1.000 Registros</button>
            <button onclick="loadData(5000)">üìà 5.000 Registros</button>
            <button onclick="loadData(10000)">üöÄ 10.000 Registros</button>
            <button onclick="loadData(25000)">üí™ 25.000 Registros</button>
            <button onclick="runBenchmark()">üèÉ Benchmark Completo</button>
            <button onclick="clearTable()">üßπ Limpar</button>
        </div>

        <div id="benchmarkResults" class="benchmark-results" style="display: none;">
            <strong>üìä Resultados do Benchmark:</strong>
        </div>

        <div class="table-container">
            <div id="performanceTable"></div>
            <div id="loadingIndicator" class="loading" style="display: none;">
                Gerando dados e renderizando tabela...
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/skargrid@latest/dist/skargrid.min.js"></script>
    <script>
        let currentTable = null;
        let benchmarkResults = [];

        // Fun√ß√£o para gerar dados de teste
        function generateTestData(count) {
            const startTime = performance.now();

            const categories = ['Eletr√¥nicos', 'Roupas', 'Alimentos', 'Livros', 'Esportes', 'Casa', 'Automotivo', 'Sa√∫de'];
            const statuses = ['Ativo', 'Inativo', 'Pendente', 'Cancelado'];
            const regions = ['Norte', 'Nordeste', 'Centro-Oeste', 'Sudeste', 'Sul'];

            const data = [];
            for (let i = 0; i < count; i++) {
                data.push({
                    id: i + 1,
                    product: `Produto ${i + 1}`,
                    category: categories[i % categories.length],
                    price: Math.round((Math.random() * 1000 + 10) * 100) / 100,
                    quantity: Math.floor(Math.random() * 1000) + 1,
                    status: statuses[i % statuses.length],
                    region: regions[i % regions.length],
                    sales: Math.floor(Math.random() * 10000),
                    rating: Math.round((Math.random() * 5) * 10) / 10,
                    createdAt: new Date(2023, Math.floor(Math.random() * 12), Math.floor(Math.random() * 28) + 1).toISOString().split('T')[0],
                    updatedAt: new Date().toISOString().split('T')[0]
                });
            }

            const endTime = performance.now();
            console.log(`üìä ${count} registros gerados em ${(endTime - startTime).toFixed(2)}ms`);

            return data;
        }

        // Configura√ß√£o das colunas
        const columns = [
            { field: 'id', title: 'ID', width: '60px', sortable: true },
            { field: 'product', title: 'Produto', sortable: true, filterType: 'text' },
            { field: 'category', title: 'Categoria', filterType: 'select', sortable: true },
            {
                field: 'price',
                title: 'Pre√ßo',
                sortable: true,
                filterType: 'number',
                render: (value) => `R$ ${value.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}`
            },
            { field: 'quantity', title: 'Quantidade', sortable: true, filterType: 'number' },
            { field: 'status', title: 'Status', filterType: 'select', sortable: true },
            { field: 'region', title: 'Regi√£o', filterType: 'select', sortable: true },
            { field: 'sales', title: 'Vendas', sortable: true, filterType: 'number' },
            { field: 'rating', title: 'Avalia√ß√£o', sortable: true, filterType: 'number' },
            {
                field: 'createdAt',
                title: 'Criado em',
                sortable: true,
                filterType: 'date',
                render: (value) => new Date(value).toLocaleDateString('pt-BR')
            }
        ];

        // Fun√ß√£o para carregar dados
        window.loadData = function(count) {
            document.getElementById('loadingIndicator').style.display = 'block';
            document.getElementById('performanceTable').innerHTML = '';

            setTimeout(() => {
                const startTime = performance.now();

                // Gerar dados
                const data = generateTestData(count);

                // Limpar tabela anterior
                if (currentTable) {
                    currentTable.destroy();
                }

                // Criar nova tabela
                currentTable = new Skargrid('performanceTable', {
                    data: data,
                    columns: columns,
                    pagination: true,
                    pageSize: 50,
                    pageSizeOptions: [25, 50, 100, 250],
                    sortable: true,
                    searchable: true,
                    columnFilters: true,
                    selectable: true,
                    exportCSV: true,
                    exportXLSX: true,
                    theme: 'light'
                });

                const endTime = performance.now();
                const renderTime = endTime - startTime;

                // Atualizar m√©tricas
                document.getElementById('recordsCount').textContent = count.toLocaleString();
                document.getElementById('renderTime').textContent = `${renderTime.toFixed(2)}ms`;
                document.getElementById('filteredCount').textContent = count.toLocaleString();

                // Calcular uso de mem√≥ria (aproximado)
                const memoryUsage = (data.length * 0.5).toFixed(1); // ~0.5KB por registro
                document.getElementById('memoryUsage').textContent = `${memoryUsage}MB`;

                document.getElementById('loadingIndicator').style.display = 'none';

                console.log(`üöÄ Tabela renderizada com ${count} registros em ${renderTime.toFixed(2)}ms`);

                // Adicionar listener para filtros
                currentTable.on('filterChange', (filteredData) => {
                    document.getElementById('filteredCount').textContent = filteredData.length.toLocaleString();
                });
            }, 100);
        };

        // Fun√ß√£o de benchmark
        window.runBenchmark = function() {
            const sizes = [1000, 5000, 10000, 15000];
            benchmarkResults = [];

            document.getElementById('benchmarkResults').style.display = 'block';
            document.getElementById('benchmarkResults').innerHTML = '<strong>üèÉ Executando Benchmark...</strong>\n\n';

            let currentIndex = 0;

            function runNextBenchmark() {
                if (currentIndex >= sizes.length) {
                    // Mostrar resultados finais
                    let results = '<strong>üìä Resultados do Benchmark Completo:</strong>\n\n';
                    results += 'Tamanho\tTempo (ms)\tRegistros/seg\n';
                    results += '‚îÄ'.repeat(40) + '\n';

                    benchmarkResults.forEach(result => {
                        const throughput = (result.size / result.time * 1000).toFixed(0);
                        results += `${result.size.toLocaleString()}\t${result.time.toFixed(2)}\t\t${throughput}\n`;
                    });

                    document.getElementById('benchmarkResults').innerHTML = results;
                    return;
                }

                const size = sizes[currentIndex];
                document.getElementById('benchmarkResults').innerHTML += `Testando ${size.toLocaleString()} registros...\n`;

                const startTime = performance.now();
                const data = generateTestData(size);

                if (currentTable) {
                    currentTable.destroy();
                }

                currentTable = new Skargrid('performanceTable', {
                    data: data,
                    columns: columns,
                    pagination: true,
                    pageSize: 50,
                    sortable: true,
                    searchable: true,
                    columnFilters: true,
                    theme: 'light'
                });

                const endTime = performance.now();
                const renderTime = endTime - startTime;

                benchmarkResults.push({ size, time: renderTime });

                document.getElementById('benchmarkResults').innerHTML +=
                    `‚úÖ ${size.toLocaleString()} registros: ${renderTime.toFixed(2)}ms\n`;

                currentIndex++;
                setTimeout(runNextBenchmark, 500);
            }

            runNextBenchmark();
        };

        // Fun√ß√£o para limpar tabela
        window.clearTable = function() {
            if (currentTable) {
                currentTable.destroy();
                currentTable = null;
            }
            document.getElementById('performanceTable').innerHTML = '';
            document.getElementById('recordsCount').textContent = '0';
            document.getElementById('renderTime').textContent = '0ms';
            document.getElementById('filteredCount').textContent = '0';
            document.getElementById('memoryUsage').textContent = '0MB';
            document.getElementById('benchmarkResults').style.display = 'none';
        };

        // Carregar dados iniciais pequenos
        setTimeout(() => loadData(1000), 500);
    </script>
</body>
</html>