<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkarGrid Massive Dataset Test - 500K Rows</title>
    <link rel="stylesheet" href="../dist/skargrid.min.css">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .demo-info { margin-bottom: 20px; padding: 15px; background: #f0f9ff; border-left: 4px solid #007acc; border-radius: 4px; }
        .demo-info h3 { margin-top: 0; color: #007acc; }
        .performance-warning { margin-top: 10px; padding: 10px; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; }
        .stats { margin-top: 10px; font-size: 12px; color: #666; }
        .performance-metrics { margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px; font-family: monospace; font-size: 11px; }
    </style>
</head>
<body>
    <h1>SkarGrid Massive Dataset Performance Test</h1>

    <div class="demo-info">
        <h3>üöÄ Extreme Performance Test: 500,000 Rows + Advanced Filters</h3>
        <p>This test demonstrates <strong>500,000 rows</strong> with virtual scrolling and <strong>advanced filtering</strong> capabilities.</p>
        <p><strong>Filter Features:</strong> Dropdown selects for Age Group, City, and Company columns.</p>
        <p><strong>Expected Performance:</strong> Instant filtering with scroll adjustment, smooth performance with millions of combinations.</p>
        <p><strong>Filter Combinations:</strong> Mix search + dropdowns for powerful data exploration.</p>

        <div class="performance-warning">
            <strong>‚ö†Ô∏è Performance Reality Check:</strong>
            <ul style="margin: 5px 0; padding-left: 20px;">
                <li><strong>500K rows is EXTREME</strong> for web browsers</li>
                <li>Data generation may take 5-15 seconds</li>
                <li>Filtering 500K rows takes time (200-1000ms)</li>
                <li>Memory usage: 50-200MB (depending on browser)</li>
                <li><strong>Real-world recommendation:</strong> Use server-side pagination/filtering</li>
                <li>This test proves virtual scrolling works, but shows browser limits</li>
            </ul>
        </div>

        <div class="stats" id="stats">Generating 500,000 rows...</div>
        <div class="performance-metrics" id="metrics"></div>
    </div>

    <div id="grid1" style="height: 600px;"></div>

    <script src="../dist/skargrid.min.js"></script>
    <script>
        // Performance monitoring
        const perfMetrics = {
            startTime: Date.now(),
            dataGenTime: 0,
            renderTime: 0,
            memoryUsage: [],
            scrollEvents: 0
        };

        function updateMetrics() {
            const now = Date.now();
            const elapsed = (now - perfMetrics.startTime) / 1000;

            let metrics = `
                <strong>Performance Metrics:</strong><br>
                ‚Ä¢ Elapsed Time: ${elapsed.toFixed(1)}s<br>
                ‚Ä¢ Data Generation: ${perfMetrics.dataGenTime}ms<br>
                ‚Ä¢ Initial Render: ${perfMetrics.renderTime}ms<br>
                ‚Ä¢ Scroll Events: ${perfMetrics.scrollEvents}<br>
            `;

            // Memory info if available
            if (performance.memory) {
                const mem = performance.memory;
                metrics += `‚Ä¢ Memory Used: ${(mem.usedJSHeapSize / 1024 / 1024).toFixed(1)} MB<br>`;
                metrics += `‚Ä¢ Memory Limit: ${(mem.jsHeapSizeLimit / 1024 / 1024).toFixed(0)} MB<br>`;
                perfMetrics.memoryUsage.push(mem.usedJSHeapSize);
            }

            document.getElementById('metrics').innerHTML = metrics;
        }

        // Generate 500,000 sample rows
        function generateMassiveDataset() {
            const dataGenStart = Date.now();
            const data = [];

            // Smaller arrays for better performance
            const firstNames = ['John', 'Jane', 'Bob', 'Alice', 'Mike', 'Sara', 'Tom', 'Lisa'];
            const lastNames = ['Smith', 'Johnson', 'Brown', 'Williams', 'Jones', 'Garcia', 'Miller', 'Davis'];
            const cities = ['NYC', 'LA', 'Chicago', 'Houston', 'Phoenix', 'Miami', 'Seattle', 'Boston'];
            const companies = ['TechCorp', 'DataSys', 'InfoTech', 'NetWorks', 'SoftWare', 'WebDev', 'CloudInc'];

            console.log('Generating 500,000 rows...');

            for (let i = 1; i <= 500000; i++) {
                const age = 18 + Math.floor(Math.random() * 62); // 18-80
                const city = cities[Math.floor(Math.random() * cities.length)];
                const company = companies[Math.floor(Math.random() * companies.length)];

                data.push({
                    id: i,
                    name: `${firstNames[Math.floor(Math.random() * firstNames.length)]} ${lastNames[Math.floor(Math.random() * lastNames.length)]}`,
                    age: age,
                    ageGroup: age < 25 ? '18-24' : age < 35 ? '25-34' : age < 45 ? '35-44' : age < 55 ? '45-54' : '55+',
                    city: city,
                    company: company,
                    salary: 30000 + Math.floor(Math.random() * 120000), // 30k-150k
                    score: Math.floor(Math.random() * 1000) // 0-999
                });

                // Progress update every 50k rows
                if (i % 50000 === 0) {
                    console.log(`Generated ${i} rows...`);
                    document.getElementById('stats').innerHTML = `Generating 500,000 rows... (${Math.round(i/5000)}%)`;
                }
            }

            perfMetrics.dataGenTime = Date.now() - dataGenStart;
            console.log(`Data generation completed in ${perfMetrics.dataGenTime}ms`);
            return data;
        }

        // Initialize grid after data generation
        setTimeout(() => {
            const renderStart = Date.now();

            const grid = new Skargrid('grid1', {
                data: generateMassiveDataset(),
                columns: [
                    { field: 'id', title: 'ID', width: 80 },
                    { field: 'name', title: 'Name', width: 150 },
                    { field: 'age', title: 'Age', width: 60 },
                    {
                        field: 'ageGroup',
                        title: 'Age Group',
                        width: 100,
                        render: (value, row) => {
                            if (row.age < 25) return '18-24';
                            if (row.age < 35) return '25-34';
                            if (row.age < 45) return '35-44';
                            if (row.age < 55) return '45-54';
                            return '55+';
                        },
                        filterable: true,
                        filterType: 'select',
                        filterOptions: ['18-24', '25-34', '35-44', '45-54', '55+']
                    },
                    {
                        field: 'city',
                        title: 'City',
                        width: 100,
                        filterable: true,
                        filterType: 'select',
                        filterOptions: ['NYC', 'LA', 'Chicago', 'Houston', 'Phoenix', 'Miami', 'Seattle', 'Boston']
                    },
                    {
                        field: 'company',
                        title: 'Company',
                        width: 120,
                        filterable: true,
                        filterType: 'select',
                        filterOptions: ['TechCorp', 'DataSys', 'InfoTech', 'NetWorks', 'SoftWare', 'WebDev', 'CloudInc']
                    },
                    { field: 'salary', title: 'Salary', width: 100, render: (value) => `$${value.toLocaleString()}` },
                    { field: 'score', title: 'Score', width: 80 }
                ],
                virtualization: true, // Critical for 500K rows
                searchable: true,
                sortable: true,
                selectable: true,
                columnFilters: true,
                exportCSV: true,
                columnConfig: true
            });

            perfMetrics.renderTime = Date.now() - renderStart;

            // Update stats
            const updateStats = () => {
                const container = document.querySelector('.skargrid-table-container');
                if (container) {
                    const scrollTop = container.scrollTop;
                    const scrollHeight = container.scrollHeight;
                    const clientHeight = container.clientHeight;
                    const scrollPercent = Math.round((scrollTop / (scrollHeight - clientHeight)) * 100);

                    const renderedRows = document.querySelectorAll('#grid1 tbody tr:not([style*="height"])').length;
                    const totalRows = grid.getData().length;

                    document.getElementById('stats').innerHTML = `
                        <strong>Live Stats:</strong> ${renderedRows} rows rendered | ${totalRows.toLocaleString()} total rows | Scrolled ${scrollPercent}%
                    `;
                }
                updateMetrics();
            };

            // Monitor scroll performance
            setTimeout(() => {
                const container = document.querySelector('.skargrid-table-container');
                if (container) {
                    let lastScrollTime = Date.now();
                    container.addEventListener('scroll', () => {
                        perfMetrics.scrollEvents++;
                        const now = Date.now();
                        if (now - lastScrollTime > 1000) { // Update every second
                            updateStats();
                            lastScrollTime = now;
                        }
                    });
                    updateStats();
                }
            }, 100);

            console.log('üöÄ Massive dataset test initialized!');
            console.log('üí° Try these filter combinations:');
            console.log('   ‚Ä¢ Age Group: "25-34" + City: "NYC"');
            console.log('   ‚Ä¢ Company: "TechCorp" + Search: "John"');
            console.log('   ‚Ä¢ Multiple filters for powerful data exploration');
        }, 100);
    </script>
</body>
</html></content>
<parameter name="filePath">docs/massive-dataset-test.html